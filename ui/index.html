<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VoiceAgent Browser</title>
<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
}
#toolbar {
    display: flex;
    padding: 8px;
    background-color: #f0f0f0;
}
#url {
    flex: 1;
    margin-right: 8px;
}
iframe {
    width: 100%;
    height: calc(100vh - 40px);
    border: none;
}
</style>
</head>
<body>
<div id="toolbar">
    <input id="url" type="text" placeholder="Enter URL" />
    <button id="go">Go</button>
</div>
<iframe id="view" sandbox="allow-same-origin allow-scripts allow-forms"></iframe>
<script>
const input = document.getElementById('url');
const button = document.getElementById('go');
const view = document.getElementById('view');

function load(url) {
    if (!url.startsWith('http')) {
        url = 'http://' + url;
    }
    view.src = url;
}

button.addEventListener('click', () => load(input.value));
input.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') load(input.value);
});

// Selection highlighting -> Python
view.addEventListener('load', () => {
    view.contentWindow.document.addEventListener('selectionchange', () => {
        const sel = view.contentWindow.getSelection();
        if (sel && sel.toString().trim() !== '') {
            const text = sel.toString();
            if (window.pywebview) {
                window.pywebview.api.on_selection(text);
            }
        }
    });
});
</script>
</body>
</html>
